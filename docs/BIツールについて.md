# BIツールについて

このリポジトリ（かんたんBIツール / LightBI）でいう「BIツール」を、MVPとして成立させるための最小要素に分解して整理します。

## 1. BIツールの最小機能（MVP）

- データ取得: SQL（主に `SELECT`）を実行して表形式の結果を得る
- 可視化: 結果を table / bar / line といったウィジェットに描画する
- ダッシュボード: 複数ウィジェットを並べて閲覧・共有できる単位
- フィルタ（パラメータ）: `from/to` などの入力でSQLを再実行できる
- CSV取り込み: 手元データをアップロードして即座に可視化できる

## 2. LightBIのアプローチ

- クエリはDBに保存し、実行時に `{{name}}` 形式の名前付きパラメータをバインド
- SQLは安全対策として `SELECT`（または `WITH`）のみ許可し、禁止語をブロック
- 取得結果には上限（強制 `LIMIT`）をかけ、重いクエリの影響を抑制

## 3. 典型的なユーザーフロー

1. CSVをアップロード（またはクエリを作成）
2. 生成されたクエリを確認・編集（必要なら `from/to` などのパラメータを追加）
3. ダッシュボードにウィジェットとして配置
4. 期間などのフィルタを適用して再実行

## 4. 非機能（最低限）

- 実行制限: statement_timeout / 最大行数
- 監査（簡易）: 実行ログ（duration, row_count, params, error）を保存

## 5. 用語

- クエリ: 保存されたSQL（+ パラメータ定義）
- ウィジェット: クエリ結果の描画単位（table/bar/line）
- ダッシュボード: ウィジェット配置（x,y,w,h）を持つ画面
