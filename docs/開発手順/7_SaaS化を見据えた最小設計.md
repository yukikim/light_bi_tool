# 開発手順 7: SaaS化を見据えた最小設計

MVPを壊さずにSaaS化できるよう、今のうちに「差し込みやすいポイント」だけを決めます。

## 1. 追加しやすい拡張点

- `tenant_id` を主要テーブルに追加（queries/dashboards/widgets/query_executions など）
- JWTに `tenant` 情報を含め、ガード/クエリ条件でスコープ
- 実行制限（回数/同時実行/時間/最大行数）をテナント設定で制御

## 2. 安全設計の強化

- 許可スキーマ/許可テーブルのホワイトリスト
- 実行前に `EXPLAIN` で危険なプランを検知
- 実行ログをテナント単位で集計

## 3. データソース

- MVPは単一DB（`DATABASE_URL`）で成立
- 将来は data_sources を追加し、暗号化保存 + 接続テスト + 実行時の接続切替

## 4. 課金/プラン（最小）

- Free: 実行回数/最大行数/保存数を小さく
- Pro: 制限緩和 + 共有機能
